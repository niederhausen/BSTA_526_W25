<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Survey Feedback from Previous Years – BSTA 526 Winter 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-sm " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/IMG_6759_med.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BSTA 526 Winter 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./readings.html"> 
<span class="menu-text">Readings</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./weeks.html"> 
<span class="menu-text">Weeks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Survey Feedback from Previous Years</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./readings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Readings</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./weeks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weeks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./function_week.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Functions of the Week</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section">2024</a>
  <ul class="collapse">
  <li><a href="#week-1" id="toc-week-1" class="nav-link" data-scroll-target="#week-1">Week 1</a>
  <ul class="collapse">
  <li><a href="#muddiest-points" id="toc-muddiest-points" class="nav-link" data-scroll-target="#muddiest-points">Muddiest points</a></li>
  <li><a href="#clearest-points" id="toc-clearest-points" class="nav-link" data-scroll-target="#clearest-points">Clearest Points</a></li>
  </ul></li>
  <li><a href="#week-2" id="toc-week-2" class="nav-link" data-scroll-target="#week-2">Week 2</a>
  <ul class="collapse">
  <li><a href="#muddiest-points-1" id="toc-muddiest-points-1" class="nav-link" data-scroll-target="#muddiest-points-1">Muddiest points</a></li>
  <li><a href="#clearest-points-1" id="toc-clearest-points-1" class="nav-link" data-scroll-target="#clearest-points-1">Clearest Points</a></li>
  </ul></li>
  <li><a href="#week-3" id="toc-week-3" class="nav-link" data-scroll-target="#week-3">Week 3</a>
  <ul class="collapse">
  <li><a href="#muddiest-points-2" id="toc-muddiest-points-2" class="nav-link" data-scroll-target="#muddiest-points-2">Muddiest points</a></li>
  </ul></li>
  <li><a href="#week-4" id="toc-week-4" class="nav-link" data-scroll-target="#week-4">Week 4</a>
  <ul class="collapse">
  <li><a href="#keyboard-shortcut-for-the-pipe-or" id="toc-keyboard-shortcut-for-the-pipe-or" class="nav-link" data-scroll-target="#keyboard-shortcut-for-the-pipe-or">Keyboard shortcut for the pipe (<code>%&gt;%</code> or <code>|&gt;</code>)</a></li>
  <li><a href="#the-difference-between-na-value-and-0" id="toc-the-difference-between-na-value-and-0" class="nav-link" data-scroll-target="#the-difference-between-na-value-and-0">The difference between NA value and 0</a></li>
  <li><a href="#across-and-its-usage" id="toc-across-and-its-usage" class="nav-link" data-scroll-target="#across-and-its-usage"><code>across()</code> and it’s usage</a></li>
  <li><a href="#and-.x" id="toc-and-.x" class="nav-link" data-scroll-target="#and-.x"><code>~</code> and <code>.x</code></a></li>
  <li><a href="#exceptions-where-we-have-seen-the-used" id="toc-exceptions-where-we-have-seen-the-used" class="nav-link" data-scroll-target="#exceptions-where-we-have-seen-the-used">Exceptions where we have seen the <code>~</code> used</a></li>
  <li><a href="#case_when-vs.-if_else" id="toc-case_when-vs.-if_else" class="nav-link" data-scroll-target="#case_when-vs.-if_else"><code>case_when</code> vs.&nbsp;<code>if_else</code></a></li>
  <li><a href="#the-difference-between-a-theme-and-and-a-palette." id="toc-the-difference-between-a-theme-and-and-a-palette." class="nav-link" data-scroll-target="#the-difference-between-a-theme-and-and-a-palette.">The difference between a theme and and a palette.</a></li>
  <li><a href="#be-careful-what-you-pipe-to-and-from" id="toc-be-careful-what-you-pipe-to-and-from" class="nav-link" data-scroll-target="#be-careful-what-you-pipe-to-and-from">Be careful what you pipe to and from</a></li>
  <li><a href="#other-muddy-points" id="toc-other-muddy-points" class="nav-link" data-scroll-target="#other-muddy-points">Other muddy points</a></li>
  </ul></li>
  <li><a href="#week-5" id="toc-week-5" class="nav-link" data-scroll-target="#week-5">Week 5</a>
  <ul class="collapse">
  <li><a href="#case_when-vs-ifelse" id="toc-case_when-vs-ifelse" class="nav-link" data-scroll-target="#case_when-vs-ifelse"><code>case_when()</code> vs <code>ifelse()</code></a></li>
  <li><a href="#separate" id="toc-separate" class="nav-link" data-scroll-target="#separate"><code>separate()</code></a></li>
  <li><a href="#herehere" id="toc-herehere" class="nav-link" data-scroll-target="#herehere"><code>here::here()</code></a></li>
  <li><a href="#what-functions-will-only-work-within-another-function-generally" id="toc-what-functions-will-only-work-within-another-function-generally" class="nav-link" data-scroll-target="#what-functions-will-only-work-within-another-function-generally">what functions will only work within another function (generally)</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Survey Feedback from Previous Years</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="section" class="level1">
<h1>2024</h1>
<section id="week-1" class="level2">
<h2 class="anchored" data-anchor-id="week-1">Week 1</h2>
<section id="muddiest-points" class="level3">
<h3 class="anchored" data-anchor-id="muddiest-points">Muddiest points</h3>
<section id="class-logistics" class="level4">
<h4 class="anchored" data-anchor-id="class-logistics">Class logistics</h4>
<ul>
<li>Will there be presentation slides in future classes, or is everything embedded into the quarto/html files for all lectures?
<ul>
<li><em>The material will primarily be in quarto/html files and not slides.</em></li>
</ul></li>
<li>Specifics of what topics will be covered exactly. * <em>I don’t have a list of all the specific functions we will be covering, but you are welcome to peruse the <a href="https://sph-r-programming-2023.netlify.app/">BSTA 504 webpage from Winter 2023</a> to get more details on topics we will be covering. We will be closely following the same class materials.</em></li>
<li>Identifying which section of the code we were discussing during the lecture
<ul>
<li><em>Thanks for letting me know. I will try to be clearer in the future, and also jump around less. Please let me know in class if you’re not sure where we are at.</em></li>
</ul></li>
<li>The material covered towards the end of the class felt a bit difficult to keep up with. I wish we would have been told to read the materials from Week 1 (or at least skim them) ahead of Day 1, because I quickly lost track of the conversation when shortcuts were used super quickly, for example, or when we jumped from chunks of code to another topic without reflecting on them. I still had 70% of the material down and I wrote great notes during the discussion (which I later filled in with the script that was on the class website), but I think it the beginner/intermediate programming lingo that was used to explain ideas here confused me at times. Thus, I struggled to keep up with discussions around packages / best coding practices, especially when they were not mentioned directly on the script (where I could follow along!).
<ul>
<li><em>Thanks for the feedback. In future years, we will reach out to students before the term to let them know about the readings to prepare for class. Please let us know if there is lingo we are using that you are not familiar with. Learning R and coding is a whole new language!</em></li>
</ul></li>
</ul>
</section>
<section id="rstudio" class="level4">
<h4 class="anchored" data-anchor-id="rstudio">RStudio</h4>
<ul>
<li>I have trouble thinking through where things are automatically downloaded, saved, and running from. I can attend office hours for this!
<ul>
<li><em>Office hours are always a great idea. I do recommend paying close attention to where files are being saved when downloading and preferably specifying their location instead using the default location. Having organized files will make working on complex analyses much easier.</em></li>
</ul></li>
<li>How to read the course material in R. While it made sense in real time it may be difficult when going back over the material.
<ul>
<li><em>Getting used to reading code and navigating the rendered html files takes a while, and is a part of learning R. Figuring out how to take notes for yourself that works for you is also a learning curve. I recommend taking notes in the qmd files as we go through them in class. After class you can summarize and transfer key points to other file formats that you are more used to using. I personally have a folder in my Google drive filled with documents on different R programming topics. It started with one file, and then eventually expanded to multiple files on different topics in an attempt to organize my notes better. Whenever I learn something new (such as an R function or handy R package) that I want to keep for future reference, I add to them with links to relevant webpages and/or filenames and locations of where I used them.</em></li>
</ul></li>
</ul>
</section>
<section id="code" class="level4">
<h4 class="anchored" data-anchor-id="code">Code</h4>
<ul>
<li>What does the pacman package do? I have it installed but I’m not sure what it is actually used for.
<ul>
<li><em>I didn’t go into <code>pacman</code> in Day 1. The <code>p_load()</code> function from the <code>pacman</code> package (usually run as <code>pacman::p_load()</code>) lets you load many packages at once without separately using the <code>library()</code> function for each individually.</em></li>
<li><em>An added bonus is that by default it will install packages you don’t already have, unless you specify <code>install = FALSE</code>.</em></li>
<li><em>Another option is to set <code>update = TRUE</code> so that it will automatically update packages. I do not use this option though since sometimes updating packages causes conflicts with other packages or older code.</em></li>
<li><em>You can read more about the different options in the <a href="https://www.rdocumentation.org/packages/pacman/versions/0.5.1/topics/p_load">documentation</a>. This <a href="https://medium.com/r-tutorials/an-alternative-to-loading-packages-in-r-using-pacman-p-load-6037903a301a">Medium article</a> also has some tips on using <code>pacman</code>.</em></li>
</ul></li>
<li>The part on when to load in packages once they’ve already been loaded in - like for example would it be good to put that as a step in our homework 1 .qmd at the top? Or not necessary since they’re already loaded in to R Studio from the work we did in class yesterday? What would happen if we try to load them in and they were already loaded in, would the .qmd file not render and show an error?
<ul>
<li><em>I always load my packages at the very top of the .qmd files, usually in the first code chunk (with the setup label). If you still have a previous R session open, then yes you don’t need to load the packages again to run code within RStudio. However, when a file is rendered it starts with an empty workspace, which is why our qmd file must include code that loads the packages (either using <code>library()</code> or <code>pacman::p_load()</code>. We don’t have to load packages at the beginning of the file, just before we have code that depends on the packages being used.</em></li>
</ul></li>
<li>I didn’t understand the part where we talked about num, char, logical combinations (line 503).
<ul>
<li><em>The content of the objects <code>char_logical</code>, <code>num_char</code>, <code>num_logical</code>, and <code>tricky</code> were designed specifically to be confusing and thus make us aware of how R will decide to assign the data type when a vector is a mix of data types. Some key takeaways are below. Let me know if you sitll have questions about this.</em>
<ul>
<li><em>Numbers and logical/boolean (<code>TRUE</code>, <code>FALSE</code>) do not have double quotes around them, but character strings do. If you add double quotes to a number or logical, then R will treat it as a character string.</em></li>
<li><em>If a vector is a mix of numbers and character strings, then the data type of the vector is character.</em></li>
<li><em>If a vector is a mix of numbers and logical, then the data type of the vector is numeric and the logical value is converted to a numeric value (<code>TRUE</code>=1, <code>FALSE</code>=0).</em></li>
<li><em>If a vector is a mix of character strings and logical, then the data type of the vector is character and the logical value is converted to a character string and no longer operates as a logical (i.e.&nbsp;no longer equal to 1 or 0).</em></li>
</ul></li>
</ul></li>
<li>Lines 614-619, confused what the ratio means there. Could you go over the correct code (or options of the correct code) for challenge 5?
<ul>
<li><em>The code <code>1:4</code> or <code>6:9</code> creates sequences of integers starting with the first specified digit and ending at the last specified digit. For example, <code>1:4</code> is the vector with the digits 1 2 3 4. You can also create decreasing sequences by making the first number the bigger one. For example, <code>9:7</code> is the vector 9 8 7.</em></li>
<li><em>Challenge 5:</em>
<ul>
<li><code>more_heights_complete &lt;- na.omit(more_heights)</code></li>
<li><code>median(more_heights_complete)</code></li>
<li><em>You could also get the median of <code>more_heights</code> without first removing the missing values with <code>median(more_heights, na.rm = TRUE)</code>.</em></li>
</ul></li>
</ul></li>
<li>how to count the TRUE values in a logical vector
<ul>
<li><code>TRUE</code> is equal to 1 in R (and <code>FALSE</code> is equal to 0), and the function <code>sum()</code> adds up the values in a vector. Thus, <code>sum(TRUE, FALSE, TRUE)</code> is equal to 2. Similarly, <code>sum(TRUE, FALSE, 5)</code> is equal to 6.</li>
<li>The way I used it in class though is by counting how many values in the vector <code>z</code> (which was 7 9 11 13) are equal to 9. To do that I used the code <code>sum(z == 9)</code>. Breaking that down, the code inside the parentheses <code>z == 9</code> is equal to <code>FALSE TRUE FALSE FALSE</code> since the <code>==</code> means “equals to” in R.</li>
<li>You can read up more on boolean and logical operators at the <a href="https://www.r-bloggers.com/2021/09/r-booleans-comparison-and-logical-operators/">R-bloggers post</a>.</li>
</ul></li>
</ul>
</section>
</section>
<section id="clearest-points" class="level3">
<h3 class="anchored" data-anchor-id="clearest-points">Clearest Points</h3>
<p><em>Thank you for the feedback!</em></p>
<section id="class-logistics-1" class="level4">
<h4 class="anchored" data-anchor-id="class-logistics-1">Class logistics</h4>
<ul>
<li>Syllabus/course structure</li>
<li>The syllabus review.</li>
<li>Overall expectations and course flow</li>
<li>Introduction to the class (first half of the class); conversation around syllabus; and the Quarto introduction</li>
</ul>
</section>
<section id="quarto" class="level4">
<h4 class="anchored" data-anchor-id="quarto">Quarto</h4>
<ul>
<li>How to create and edit a Quarto document in RStudio.</li>
<li>The differences between quarto and markdown</li>
<li>rmarkdown is no more, quarto it is!</li>
</ul>
</section>
<section id="coding" class="level4">
<h4 class="anchored" data-anchor-id="coding">Coding</h4>
<ul>
<li>Having code missing and fixing it in front of the class was helpful in troubleshooting.</li>
<li>Just running through all the commands was very clear and easy to follow</li>
<li>Basic R set up for quarto and introduction to R objects, vectors, etc.</li>
<li>Introduction, functions, and explanations was the clearest for me.</li>
<li>Classification of the objects in logical, character, and numeric</li>
<li>Not necessarily a point, but I really liked when we were encouraged to use the shortcut keys for various commands on R and other little things like switching code between console vs inline , I have used R before for a class briefly but I never knew all these ways by which I can save time and be efficient while writing a code.</li>
</ul>
</section>
</section>
</section>
<section id="week-2" class="level2">
<h2 class="anchored" data-anchor-id="week-2">Week 2</h2>
<section id="muddiest-points-1" class="level3">
<h3 class="anchored" data-anchor-id="muddiest-points-1">Muddiest points</h3>
<ul>
<li>When discussing untidy data, the difference between long data and wide data was unclear.
<ul>
<li><em>We’ll be discussing the difference between long and wide data in more detail later in the course when we convert a dataset between the two. For now, you can take a look at an <a href="https://jminnier-berd-r-courses.netlify.app/02-data-wrangling-tidyverse/02_data_wrangling_slides_part2.html#27">example I created for our BERD R workshops</a>. The wide data in that example are not “tidy” since each cell contains two pieces of information: both the SBP and the visit number. In contrast, the long data have a separate column indicating which visit number the data in a given row are from.</em></li>
</ul></li>
<li>for the “summary()” function, is there a way to summarize all but one variable in a dataset?
<ul>
<li><em>Yes! I sometimes restrict a dataset to a couple of variables for which I want to see the summary. I usually use the <code>select()</code> function for this, which we will be covering later in the course. For now, you can take a look at some <a href="https://jminnier-berd-r-courses.netlify.app/02-data-wrangling-tidyverse/02_data_wrangling_slides_part1.html#29">select() examples from the BERD R workshops</a> (see slides 29-32).</em></li>
</ul></li>
<li>Differences between a tibble and a data.frame
<ul>
<li><em>I’m not surprised to see this show up as a muddiest point! Depending on your level of experience with R, at this point in the class some of the differences are difficult to explain since we haven’t done much coding yet. The <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html">tibble vignette</a> lists some of the differences though if you are interested. For our purposes, they are almost the same thing. When some differences come up later in the course, I will point them out.</em></li>
</ul></li>
</ul>
</section>
<section id="clearest-points-1" class="level3">
<h3 class="anchored" data-anchor-id="clearest-points-1">Clearest Points</h3>
<p><em>Thanks for the feedback!</em></p>
<ul>
<li>I enjoyed going through the code and viewing the functions. I haven’t really used <code>skimr</code> before and that was nice to see.
<ul>
<li><em>I like using <code>skmir</code>, but have recently been using <code>get_summary_stats()</code> from the <code>rstatix</code> package when teaching. It is only for numeric variables though. See a <a href="https://niederhausen.github.io/BSTA_511_F23/slides/Day03_bsta511.html#/get_summary_stats-from-rstatix-package"><code>get_summary_stats()</code> example from my BSTA 511 class</a>.</em></li>
</ul></li>
<li>Loading data.</li>
<li>How to load data into R was clearest.
<ul>
<li><em>Good to know that loading data was clear. This part can be tricky sometimes!</em></li>
</ul></li>
<li>ggplot
<ul>
<li><em>Hopefully this will still be clear when we cover more advanced options in <code>ggplot</code>!</em></li>
</ul></li>
</ul>
</section>
</section>
<section id="week-3" class="level2">
<h2 class="anchored" data-anchor-id="week-3">Week 3</h2>
<section id="muddiest-points-2" class="level3">
<h3 class="anchored" data-anchor-id="muddiest-points-2">Muddiest points</h3>
<section id="here-package" class="level4">
<h4 class="anchored" data-anchor-id="here-package">here package</h4>
<p>The here package takes a bit to explaining, but, compared to the old way of doing things, it is a real life saver. The issue in the past had to do with relative file paths, especially with <code>.qmd</code> files that are saved in sub-folders. The <code>.qmd</code> file recognizes where it is saved as the root file path, which is okay with a one-off <code>.qmd</code> file. But when working in projects (recommended) and striving for reproducible R code (highly recommended), the <code>here</code> package save a lot of headache.</p>
<p>For further reading: + <a href="https://malco.io/articles/2018-11-05-why-should-i-use-the-here-package-when-i-m-already-using-projects">Why should I use the here package when I’m already using projects?</a> by Malcolm Barrett. + <a href="http://jenrichmond.rbind.io/post/how-to-use-the-here-package/">how to use the <code>here</code> package</a> by Jenny Richmond. + <a href="https://here.r-lib.org/articles/here.html">here package vignette</a> + <a href="https://cran.r-project.org/web/packages/here/vignettes/rmarkdown.html">Using here with rmarkdown</a></p>
<p>Project-oriented workflows are recommended. Here package solves some old headaches. It gets easier with practice.</p>
<section id="question-about-using-here" class="level5">
<h5 class="anchored" data-anchor-id="question-about-using-here">Question about using here</h5>
<blockquote class="blockquote">
<p>… how [here] can be used in certain instances where one may not remember if they switched to a new qmd file? In that case, would you suggest to use the “here” command each time you work on a project where there’s a chance that you’ll switch between qmd files and would like to use the same data file throughout? Is there any other way to better use this function or tips on how you deal with it?</p>
</blockquote>
<p>There is a difference between working interactively in RStudio where data are loaded to the Environment. In this case, loading a data set once means that it can be used in any other code while working in the environment.</p>
<p>Issues will com up when you go to render a <code>.qmd</code> that doesn’t have the data loaded within that <code>.qmd</code>. It won’t look to the environment for the data; it looks to the filepath that you specify in the <code>.qmd</code>. Best practice is to <em>write the code</em> to load the data in each <code>.qmd</code> or <code>.R</code> script so that R knows where to look for the data that you want it to operate on / analyze.</p>
</section>
</section>
<section id="the-function.-it-seems-like-sometimes-we-use-and-sometimes-we-use--.-are-they-interchangeable-or-each-with-different-types-of-functions" class="level4">
<h4 class="anchored" data-anchor-id="the-function.-it-seems-like-sometimes-we-use-and-sometimes-we-use--.-are-they-interchangeable-or-each-with-different-types-of-functions">The ! function. It seems like sometimes we use ! and sometimes we use -. Are they interchangeable, or each with different types of functions?</h4>
<ul>
<li><code>!</code> – the exclamation point can be read as “not” it is primarily used in logical statements</li>
<li><code>-</code> – the minus sign can be used in more instances
<ul>
<li>to do actual arithmetic (i.e.&nbsp;subtraction)</li>
<li>to indicate a negative number</li>
<li>with <code>dplyr::select()</code> to remove or not select a column, or exclusion</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtraction</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">-</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Negation</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selection/exclusion</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(starwars, <span class="sc">-</span>height) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 87
Columns: 13
$ name       &lt;chr&gt; "Luke Skywalker", "C-3PO", "R2-D2", "Darth Vader", "Leia Or…
$ mass       &lt;dbl&gt; 77.0, 75.0, 32.0, 136.0, 49.0, 120.0, 75.0, 32.0, 84.0, 77.…
$ hair_color &lt;chr&gt; "blond", NA, NA, "none", "brown", "brown, grey", "brown", N…
$ skin_color &lt;chr&gt; "fair", "gold", "white, blue", "white", "light", "light", "…
$ eye_color  &lt;chr&gt; "blue", "yellow", "red", "yellow", "brown", "blue", "blue",…
$ birth_year &lt;dbl&gt; 19.0, 112.0, 33.0, 41.9, 19.0, 52.0, 47.0, NA, 24.0, 57.0, …
$ sex        &lt;chr&gt; "male", "none", "none", "male", "female", "male", "female",…
$ gender     &lt;chr&gt; "masculine", "masculine", "masculine", "masculine", "femini…
$ homeworld  &lt;chr&gt; "Tatooine", "Tatooine", "Naboo", "Tatooine", "Alderaan", "T…
$ species    &lt;chr&gt; "Human", "Droid", "Droid", "Human", "Human", "Human", "Huma…
$ films      &lt;list&gt; &lt;"A New Hope", "The Empire Strikes Back", "Return of the J…
$ vehicles   &lt;list&gt; &lt;"Snowspeeder", "Imperial Speeder Bike"&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, "Imp…
$ starships  &lt;list&gt; &lt;"X-wing", "Imperial shuttle"&gt;, &lt;&gt;, &lt;&gt;, "TIE Advanced x1",…</code></pre>
</div>
</div>
</section>
<section id="using-the-fill-command" class="level4">
<h4 class="anchored" data-anchor-id="using-the-fill-command">Using the fill command</h4>
<p>We didn’t cover it in the lecture notes, but then it appeared in the example. I suggest to read/work through the <a href="https://tidyr.tidyverse.org/reference/fill.html">fill vignette</a>; the examples there are good ones to show what the function does. Then look back a the <code>smoke_messy</code> data set in Part 3 and think about why this command would be useful to clean up the data and for <em>fill</em>ing in missing values.</p>
</section>
<section id="loading-data-into-r" class="level4">
<h4 class="anchored" data-anchor-id="loading-data-into-r">Loading data into R</h4>
<p>It gets easier and hopefully you get to see more example in the notes and practice with the homework. <a href="http://www.sthda.com/english/wiki/importing-data-into-r">This tutorial</a> is pretty good. So is the <a href="https://readxl.tidyverse.org/">readxl vignette</a> and the <a href="https://readr.tidyverse.org/">readr vignette</a>.</p>
</section>
<section id="reasonable-width-height-and-dpi-values-when-using-ggsave" class="level4">
<h4 class="anchored" data-anchor-id="reasonable-width-height-and-dpi-values-when-using-ggsave">Reasonable width, height, and dpi values when using ggsave</h4>
<p>This takes some trial and error and depends on the purpose. For draft figures, dpi = 70 might be okay, but a journal might require dpi above 300 for publication. In Quarto, rendering an html, the figure defaults are 7x5 inches (<a href="https://quarto.org/docs/computations/execution-options.html">Link</a>). We talked about in class how you can use the plot panes to size your figures by trial and error.</p>
</section>
<section id="the-tidyselect-section" class="level4">
<h4 class="anchored" data-anchor-id="the-tidyselect-section">The <code>tidyselect</code> section</h4>
<p>There were pretty good resources in the notes</p>
<ul>
<li><p>See some more examples in <a href="https://jminnier-berd-r-courses.netlify.app/02-data-wrangling-tidyverse/02_data_wrangling_slides_part1.html#32">this slide</a></p></li>
<li><p>For more info and learning about tidyselect, please run this code in your console:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install remotes package</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use remotes to install this package from github</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"laderast/tidyowl"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># load tidyowl package</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyowl)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># interactive tutorial</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>tidyowl<span class="sc">::</span><span class="fu">learn_tidyselect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://dplyr.tidyverse.org/reference/dplyr_tidy_select.html">Here is also a link</a> with a list of the selectors and links to each one. For example, there is a link to <a href="https://tidyselect.r-lib.org/reference/starts_with.html"><code>starts_with</code></a> and a bunch of examples.</p>
</section>
</section>
</section>
<section id="week-4" class="level2">
<h2 class="anchored" data-anchor-id="week-4">Week 4</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>               readxl, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>               janitor,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>               here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"smoke_complete.xlsx"</span>), </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sheet =</span> <span class="dv">1</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">na =</span> <span class="st">"NA"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                                     </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::glimpse(smoke_complete)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="keyboard-shortcut-for-the-pipe-or" class="level3">
<h3 class="anchored" data-anchor-id="keyboard-shortcut-for-the-pipe-or">Keyboard shortcut for the pipe (<code>%&gt;%</code> or <code>|&gt;</code>)</h3>
<p>In office hours, someone didn’t know about this fact and wanted to make sure everyone knows about it.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important keyboard shortcut
</div>
</div>
<div class="callout-body-container callout-body">
<p>In RStudio the keyboard shortcut for the pipe operator <code>%&gt;%</code> (or native pipe <code>|&gt;</code>) is <code>Ctrl + Shift + M</code> (Windows) or <code>Cmd + Shift + M</code> (Mac).</p>
<p>Note: <code>Ctrl + Shift + M</code> also works on a Mac.</p>
</div>
</div>
</section>
<section id="the-difference-between-na-value-and-0" class="level3">
<h3 class="anchored" data-anchor-id="the-difference-between-na-value-and-0">The difference between NA value and 0</h3>
<section id="na-not-available" class="level4">
<h4 class="anchored" data-anchor-id="na-not-available">NA (Not Available)</h4>
<ul>
<li><code>NA</code> is a special value in R that represents missing or undefined data.</li>
<li><code>0</code> is a numeric value representing the number zero. It is a valid and well-defined numerical value in R.</li>
<li>It’s important to handle <code>NA</code> values appropriately in data analysis and to consider their impact on calculations, as operations involving <code>NA</code> may result in <code>NA</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">+</span> <span class="dv">5</span>  <span class="co"># The result is NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="sc">+</span> <span class="dv">5</span>  <span class="co"># The results is 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)  <span class="co"># The result is NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the argument na.rm = TRUE, means to ignore the NAs</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># The results is 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x) <span class="co"># The result is 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
</section>
</section>
<section id="across-and-its-usage" class="level3">
<h3 class="anchored" data-anchor-id="across-and-its-usage"><code>across()</code> and it’s usage</h3>
<p>The biggest advantage that across brings is the ability to perform the same data manipulation task to multiple columns.</p>
<p>Below the values in three columns are all set to the mean value using the <code>mean()</code>. I had to write out the function and the variable names three times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">days_to_death =</span> <span class="fu">mean</span>(days_to_death, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">days_to_birth =</span> <span class="fu">mean</span>(days_to_birth, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">days_to_last_follow_up =</span> <span class="fu">mean</span>(days_to_last_follow_up, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "stage ia", "stage ib", "stage ib", "stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "dead", "dead", "dead", "alive", "alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 852.5637, 852.5637, 852.5637, 852.5637, 85…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24175.38, -24175.38, -24175.38, -24175.38…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; 944.8547, 944.8547, 944.8547, 944.8547, 94…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;chr&gt; "male", "male", "female", "male", "female"…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "white", "asian", "white", "white", "not r…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…</code></pre>
</div>
</div>
<p>The same thing is accomplished using <code>across()</code> but we only have to call the <code>mean()</code> function once.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(days_to_death, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                                 days_to_birth, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                                 days_to_last_follow_up), </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "stage ia", "stage ib", "stage ib", "stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "dead", "dead", "dead", "alive", "alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 852.5637, 852.5637, 852.5637, 852.5637, 85…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24175.38, -24175.38, -24175.38, -24175.38…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; 944.8547, 944.8547, 944.8547, 944.8547, 94…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;chr&gt; "male", "male", "female", "male", "female"…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "white", "asian", "white", "white", "not r…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…</code></pre>
</div>
</div>
<section id="links-to-check-out" class="level4">
<h4 class="anchored" data-anchor-id="links-to-check-out">Links to check out</h4>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/across.html"><code>across()</code> vignette</a></li>
<li><a href="https://willhipson.netlify.app/post/dplyr_across/dplyr_across/">Why I love dplyr’s across</a></li>
</ul>
</section>
</section>
<section id="and-.x" class="level3">
<h3 class="anchored" data-anchor-id="and-.x"><code>~</code> and <code>.x</code></h3>
<p>We’ve seen the <code>~</code> and <code>.x</code> used with <code>dplyr::across()</code>. We will see them again later when we get to the package <code>purrr</code>.</p>
<p>In the tidyverse, <code>~</code> and <code>.x</code> are used to create what they call <em>lambda</em> functions which are part of the <code>purrr</code> syntax. We have not talked about functions yet, but <code>purrr</code> package and the <code>dplyr::across()</code> function allow you to specify functions to apply in a few different ways:</p>
<ol type="1">
<li><strong>A named function, e.g.&nbsp;<code>mean</code>.</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(days_to_death, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                                 days_to_birth, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                                 days_to_last_follow_up), </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.fns =</span> mean)) <span class="sc">|&gt;</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "stage ia", "stage ib", "stage ib", "stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "dead", "dead", "dead", "alive", "alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24175.38, -24175.38, -24175.38, -24175.38…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;chr&gt; "male", "male", "female", "male", "female"…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "white", "asian", "white", "white", "not r…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Above, just using the function name, we are not able to provide the additional argument <code>na.rm = TRUE</code> to the <code>mean()</code> function, so the columns are now all <code>NA</code> values because there were missing (<code>NA</code>) values in those columns.</p>
</div>
</div>
<ol start="2" type="1">
<li><strong>An anonymous function, e.g.&nbsp;<code>\(x) x + 1</code> or <code>function(x) x + 1</code>.</strong></li>
</ol>
<p>This has not been covered yet. R lets you specify your own functions and there are two basic ways to do it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(days_to_death, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                                 days_to_birth, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                                 days_to_last_follow_up), </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.fns =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "stage ia", "stage ib", "stage ib", "stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "dead", "dead", "dead", "alive", "alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 852.5637, 852.5637, 852.5637, 852.5637, 85…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24175.38, -24175.38, -24175.38, -24175.38…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; 944.8547, 944.8547, 944.8547, 944.8547, 94…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;chr&gt; "male", "male", "female", "male", "female"…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "white", "asian", "white", "white", "not r…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…</code></pre>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(days_to_death, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                                 days_to_birth, </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                                 days_to_last_follow_up), </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.fns =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "stage ia", "stage ib", "stage ib", "stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "dead", "dead", "dead", "alive", "alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 852.5637, 852.5637, 852.5637, 852.5637, 85…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24175.38, -24175.38, -24175.38, -24175.38…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; 944.8547, 944.8547, 944.8547, 944.8547, 94…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;chr&gt; "male", "male", "female", "male", "female"…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "white", "asian", "white", "white", "not r…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Now we are able to use the additional argument <code>na.rm = TRUE</code> and the columns are now the means of the valid values in those columns.</p>
</div>
</div>
<ol start="3" type="1">
<li><strong>A purrr-style lambda function, e.g.&nbsp;<code>~ mean(.x, na.rm = TRUE)</code></strong></li>
</ol>
<p>We use <code>~</code> to indicate that we are supplying a lambda function and we use <code>.x</code> as a placeholder for the argument within our lambda function to indicate where to use the variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(days_to_death, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                                 days_to_birth, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                                 days_to_last_follow_up), </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "stage ia", "stage ib", "stage ib", "stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "dead", "dead", "dead", "alive", "alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 852.5637, 852.5637, 852.5637, 852.5637, 85…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24175.38, -24175.38, -24175.38, -24175.38…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; 944.8547, 944.8547, 944.8547, 944.8547, 94…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;chr&gt; "male", "male", "female", "male", "female"…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "white", "asian", "white", "white", "not r…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…</code></pre>
</div>
</div>
<section id="links-to-check-out-1" class="level4">
<h4 class="anchored" data-anchor-id="links-to-check-out-1">Links to check out</h4>
<p>Some of these are <code>purrr</code> focused which we have not covered yet. Others use <code>dplyr::across()</code> withing the <code>dplyr::summarize()</code> function which we will be covering soon</p>
<ul>
<li><a href="https://stackoverflow.com/questions/68249625/meaning-of-tilde-and-dot-notation-in-dplyr">Meaning of tilde and dot notation in dplyr</a></li>
<li><a href="https://stackoverflow.com/questions/70665707/what-is-the-meaning-of-and-inside-the-function-map">What is the meaning of ‘~’ and ‘.’ inside the function map?</a></li>
<li><a href="https://dplyr.tidyverse.org/reference/across.html"><code>across()</code> vignette</a></li>
<li><a href="https://willhipson.netlify.app/post/dplyr_across/dplyr_across/">Why I love dplyr’s across</a></li>
</ul>
</section>
</section>
<section id="exceptions-where-we-have-seen-the-used" class="level3">
<h3 class="anchored" data-anchor-id="exceptions-where-we-have-seen-the-used">Exceptions where we have seen the <code>~</code> used</h3>
<p>In class, we have seen three instances where the <code>~</code> is used that is not for a lambda function.</p>
<section id="case_when" class="level4">
<h4 class="anchored" data-anchor-id="case_when"><code>case_when</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>      cigarettes_per_day <span class="sc">&lt;</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"0-5"</span>, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>      cigarettes_per_day <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"6+"</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">|&gt;</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_category =</span> <span class="fu">factor</span>(cigarettes_category)) <span class="sc">|&gt;</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(cigarettes_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> cigarettes_category    n    percent
                 0-5 1100 0.95486111
                  6+   52 0.04513889</code></pre>
</div>
</div>
</section>
<section id="facet_wrap" class="level4">
<h4 class="anchored" data-anchor-id="facet_wrap"><code>facet_wrap</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smoke_complete, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age_at_diagnosis, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> cigarettes_per_day)) <span class="sc">+</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> disease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survey_feedback_previous_years_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Per the <a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html"><code>facet_wrap</code> vignettte</a>:</p>
<blockquote class="blockquote">
<p>For compatibility with the classic interface, can also be a formula or character vector. Use either a one sided formula, <code>~a + b</code>, or a character vector, <code>c("a", "b")</code>.</p>
</blockquote>
<p>Here it is being used to specify a formula.</p>
<p>Though per the vignette, the <code>vars()</code> function is preferred syntax:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smoke_complete, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age_at_diagnosis, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> cigarettes_per_day)) <span class="sc">+</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(ggplot2<span class="sc">::</span><span class="fu">vars</span>(disease))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survey_feedback_previous_years_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="facet_grid" class="level4">
<h4 class="anchored" data-anchor-id="facet_grid"><code>facet_grid</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smoke_complete, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age_at_diagnosis, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> cigarettes_per_day)) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(disease <span class="sc">~</span> vital_status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survey_feedback_previous_years_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Per the <a href="https://ggplot2.tidyverse.org/reference/facet_grid.html"><code>facet_grid</code> vignettte</a>:</p>
<blockquote class="blockquote">
<p>For compatibility with the classic interface, rows can also be a formula with the rows (of the tabular display) on the LHS and the columns (of the tabular display) on the RHS; the dot in the formula is used to indicate there should be no faceting on this dimension (either row or column).</p>
</blockquote>
<p>Again, it is being used to specify a formula.</p>
<p>Though per the vignette, the <code>ggplot2::vars()</code> function with the arguments <code>rows</code> and <code>cols</code> seems to be preferred:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smoke_complete, </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age_at_diagnosis, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> cigarettes_per_day)) <span class="sc">+</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(disease), </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">cols =</span> ggplot2<span class="sc">::</span><span class="fu">vars</span>(vital_status))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survey_feedback_previous_years_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note: <code>dplyr::vars()</code> and <code>dplyr::ggplot2()</code> are the same function in different packages and can be used interchangeably.</p>
</section>
</section>
<section id="case_when-vs.-if_else" class="level3">
<h3 class="anchored" data-anchor-id="case_when-vs.-if_else"><code>case_when</code> vs.&nbsp;<code>if_else</code></h3>
<p>In dplyr, both <code>if_else()</code> and <code>case_when()</code> are used for conditional transformations, but they have different use cases and behaviors.</p>
<ol type="1">
<li><code>if_else</code> function</li>
</ol>
<ul>
<li><code>if_else()</code> is designed for simple vectorized conditions and is particularly useful when you have a <em>binary</em> condition (i.e., two possible outcomes).</li>
<li>It evaluates a condition for each element of a vector and returns one of two values based on whether the condition is <code>TRUE</code> or <code>FALSE</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_category =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(cigarettes_per_day <span class="sc">&lt;</span> <span class="dv">6</span>, <span class="st">"0-5"</span>, <span class="st">"6+"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_category =</span> <span class="fu">factor</span>(cigarettes_category)) <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(cigarettes_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> cigarettes_category    n    percent
                 0-5 1100 0.95486111
                  6+   52 0.04513889</code></pre>
</div>
</div>
<p>In this example, the column <code>cigarettes_category</code> is assigned the value “0-5” if <code>cigarettes_per_day</code> is less than 6 and “6+” otherwise.</p>
<ol start="2" type="1">
<li><code>case_when()</code> function</li>
</ol>
<ul>
<li><code>case_when()</code> is more versatile and is suitable for handling multiple conditions with multiple possible outcomes. It is essentially a vectorized form of a <code>switch</code> or <code>if_else</code> chain.</li>
<li>It allows you to specify multiple conditions and their corresponding values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>smoke_complete <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>      cigarettes_per_day <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"0 to 2"</span>, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>      cigarettes_per_day <span class="sc">&lt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"2 to 4"</span>, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>      cigarettes_per_day <span class="sc">&lt;</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"4 to 6"</span>, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>      cigarettes_per_day <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"6+"</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">|&gt;</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_category =</span> <span class="fu">factor</span>(cigarettes_category)) <span class="sc">|&gt;</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(cigarettes_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> cigarettes_category   n    percent
              0 to 2 455 0.39496528
              2 to 4 493 0.42795139
              4 to 6 152 0.13194444
                  6+  52 0.04513889</code></pre>
</div>
</div>
<p>In this example, the column <code>cigarettes_category</code> is assigned the value “0 to 2” if <code>cigarettes_per_day</code> is less than 2, “2 to 4” if less than 4 (but greater than 2), “4 to 6” if less than 6 (but greater than 4), and “6+” otherwise.</p>
<p>Use <code>if_else()</code> when you have a simple binary condition, and use <code>case_when()</code> when you need to handle multiple conditions with different outcomes. <code>case_when()</code> is more flexible and expressive when dealing with complex conditional transformations.</p>
</section>
<section id="the-difference-between-a-theme-and-and-a-palette." class="level3">
<h3 class="anchored" data-anchor-id="the-difference-between-a-theme-and-and-a-palette.">The difference between a theme and and a palette.</h3>
<p>In <code>ggplot2</code>, a theme and a palette serve different purposes and are used in different contexts. In summary, a theme controls the overall appearance of the plot, while a palette is specifically related to the colors used to represent different groups or levels within the data. Both themes and palettes contribute to visual appeal and readability of your plot.</p>
<ol type="1">
<li><strong>Theme:</strong></li>
</ol>
<ul>
<li>A theme in <code>ggplot2</code> refers to the overall visual appearance of the plot. It includes elements such as fonts, colors, grid lines, background, and other visual attributes that define the look and feel of the entire plot.</li>
<li>Themes are set using functions like <code>theme_minimal()</code>, <code>theme_classic()</code>, or custom themes created with the <code>theme()</code> function. Themes control the global appearance of the plot.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example using theme_minimal()</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smoke_complete, </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age_at_diagnosis, </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> cigarettes_per_day)) <span class="sc">+</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survey_feedback_previous_years_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Palette:</strong></li>
</ol>
<ul>
<li>A palette, on the other hand, refers to a set of colors used to represent different levels or categories in the data. It is particularly relevant when working with categorical or discrete data where you want to distinguish between different groups.</li>
<li>Palettes are set using functions like <code>scale_fill_manual()</code> or <code>scale_color_manual()</code>. You can specify a vector of colors or use pre-defined palettes from packages like RColorBrewer or viridis (we looked at the viridis package in class).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example using a color palette</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smoke_complete, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age_at_diagnosis, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> cigarettes_per_day, </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> disease)) <span class="sc">+</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"blue"</span>, </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"green"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survey_feedback_previous_years_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="be-careful-what-you-pipe-to-and-from" class="level3">
<h3 class="anchored" data-anchor-id="be-careful-what-you-pipe-to-and-from">Be careful what you pipe to and from</h3>
<p>An error came up where a data frame was being piped to a function that did not accept a data frame as an argument (it accepted a vector)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># starwars data frame was loaded earlier with the ggplot2 package</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">|&gt;</span>  </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">n_distinct</span>(species) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'species' not found</code></pre>
</div>
</div>
<ul>
<li><code>starwars</code> is a data frame.</li>
<li><code>dplyr::n_distinct()</code> only accepts a vector as an argument (check the help <code>?dplyr::n_distinct</code>)</li>
</ul>
<p>So we need to pipe a vector to the <code>dplyr::n_distinct()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">n_distinct</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38</code></pre>
</div>
</div>
<p><code>dplyr::select()</code> accepts a data frame as its first argument and it return a vector (see the help <code>?dplyr::select</code>) which we can then pipe to <code>dplyr::n_distinct()</code>.</p>
<p>The <code>%&gt;%</code> or <code>|&gt;</code> takes the output of the expression on its left and passes it as the first argument to the function on its right. The class / type of output on the left needs to agree or be acceptable as the first argument to the function on the right.</p>
</section>
<section id="other-muddy-points" class="level3">
<h3 class="anchored" data-anchor-id="other-muddy-points">Other muddy points</h3>
<ul>
<li>Remembering applicable functions. Troubleshooting.</li>
</ul>
<blockquote class="blockquote">
<p>This gets better with experience. You are all still very new to R so be patient with yourself.</p>
</blockquote>
<ul>
<li>How to organize all of the material to understand the structure of how the R language works, rather than to keep track of all of the commands in an anecdotal way.</li>
</ul>
<blockquote class="blockquote">
<p>Again, I think that this gets better with experience. Though the R language, being open source, a lot of syntax is package dependent. So you need to be careful that some of the syntax we use with <code>dplyr</code> and the <code>tidyverse</code> will be different in base R or in other packages. This is something that comes with open source software (compared to Stata or SAS). The good news is that learning to use packages sets you up to better learn newer (to you) packages down the road.</p>
</blockquote>
</section>
</section>
<section id="week-5" class="level2">
<h2 class="anchored" data-anchor-id="week-5">Week 5</h2>
<section id="case_when-vs-ifelse" class="level3">
<h3 class="anchored" data-anchor-id="case_when-vs-ifelse"><code>case_when()</code> vs <code>ifelse()</code></h3>
<p><em>The difference between case_when and ifelse</em></p>
<ul>
<li><code>ifelse()</code> is the base R version of tidyverse’s <code>case_when()</code></li>
<li>I prefer using <code>case_when()</code> since it’s easier to follow the logic.</li>
<li><code>case_when()</code> is especially useful when there are more than two logical conditions being used.</li>
</ul>
<p>The example below creates a binary variable for bill length (long vs not long) using both <code>case_when()</code> and <code>ifelse()</code> as a comparison.</p>
<ul>
<li>Compare the crosstabs of the two variables!</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      species          island    bill_length_mm  bill_depth_mm  
 Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10  
 Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60  
 Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30  
                                 Mean   :43.92   Mean   :17.15  
                                 3rd Qu.:48.50   3rd Qu.:18.70  
                                 Max.   :59.60   Max.   :21.50  
                                 NA's   :2       NA's   :2      
 flipper_length_mm  body_mass_g       sex           year     
 Min.   :172.0     Min.   :2700   female:165   Min.   :2007  
 1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007  
 Median :197.0     Median :4050   NA's  : 11   Median :2008  
 Mean   :200.9     Mean   :4202                Mean   :2008  
 3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009  
 Max.   :231.0     Max.   :6300                Max.   :2009  
 NA's   :2         NA's   :2                                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">long_bill1 =</span> <span class="fu">case_when</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>      bill_length_mm <span class="sc">&gt;=</span> <span class="dv">45</span> <span class="sc">~</span> <span class="st">"long"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      bill_length_mm <span class="sc">&lt;</span> <span class="dv">45</span> <span class="sc">~</span> <span class="st">"not long"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">long_bill2 =</span> <span class="fu">ifelse</span>(bill_length_mm <span class="sc">&gt;=</span> <span class="dv">45</span>, <span class="st">"long"</span>, <span class="st">"not long"</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(long_bill1, long_bill2) <span class="sc">%&gt;%</span> </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            long_bill2             
 long_bill1       long not long NA_
       long        166        0   0
   not long          0      176   0
       &lt;NA&gt;          0        0   2</code></pre>
</div>
</div>
<p>Below is an example using <code>case_when()</code> to create a categorical variable with 3 groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">long_bill3 =</span> <span class="fu">case_when</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>      bill_length_mm <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"long"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>      bill_length_mm <span class="sc">&lt;=</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"short"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"medium"</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(long_bill3, long_bill1) <span class="sc">%&gt;%</span> </span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            long_bill1             
 long_bill3       long not long NA_
       long         57        0   0
     medium        109       76   2
      short          0      100   0</code></pre>
</div>
</div>
<ul>
<li>Creating a categorical variable with 3 groups can be done with <code>ifelse()</code>, but it’s harder to follow the logic:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">long_bill4 =</span> <span class="fu">ifelse</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>      bill_length_mm <span class="sc">&gt;=</span> <span class="dv">50</span>, <span class="st">"long"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(bill_length_mm <span class="sc">&lt;=</span> <span class="dv">40</span>, <span class="st">"short"</span>, <span class="st">"medium"</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(long_bill3, long_bill4) <span class="sc">%&gt;%</span> </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_title</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            long_bill4                 
 long_bill3       long medium short NA_
       long         57      0     0   0
     medium          0    185     0   2
      short          0      0   100   0</code></pre>
</div>
</div>
</section>
<section id="separate" class="level3">
<h3 class="anchored" data-anchor-id="separate"><code>separate()</code></h3>
<p><em>Different ways of using the function separate, it was a bit unclear that when to use one or the other or examples of my research data where it’ll be most relevant to use.</em></p>
<ul>
<li>Choosing the “best” way of using <code>separate()</code> is overwhelming at first.</li>
<li>I recommend starting with the simplest use case with a string being specified in <code>sep = " "</code>:</li>
</ul>
<blockquote class="blockquote">
<p><code>separate(data, col, into, sep = " ")</code></p>
</blockquote>
<ul>
<li>Which of the various versions we showed to use depends on how the data being separated are structured.</li>
<li>Most of the time I have a simple character, such as a space (<code>sep = " "</code>) or a comma (<code>sep = ","</code>) that I want to separate by.</li>
<li>If the data are structured in a more complex way, then one of the <code>stringr</code> package options might come in handy.</li>
</ul>
</section>
<section id="herehere" class="level3">
<h3 class="anchored" data-anchor-id="herehere"><code>here::here()</code></h3>
<p><em>TSV files, very neat… But also, I got a bit confused when you did the render process around 22:00-23:00 minutes. Also, “here: and also”here” Directories/root directories. I was a bit confused about in what situations we would tangibly utilize this/if it is beneficial.</em></p>
<ul>
<li>Great question! This is definitely not intuitive, which is why I wanted to demonstrate it in class.</li>
<li>The key is that
<ul>
<li>when rendering a qmd file the current working directory is the folder the file is sitting in,</li>
<li>while when running code in a file within RStudio the working directory is the folder where the <code>.Rproj</code> file is located.<br>
</li>
</ul></li>
<li>This distinction is important when loading other files from our computer during our workflow, and why <code>here::here()</code> makes our workflow so much easier!</li>
</ul>
</section>
<section id="what-functions-will-only-work-within-another-function-generally" class="level3">
<h3 class="anchored" data-anchor-id="what-functions-will-only-work-within-another-function-generally">what functions will only work within another function (generally)</h3>
<ul>
<li>I’m not aware of functions that only work standalone within other functions. For example, the <code>mean()</code> function works on its own, but can also be used within a <code>summarise()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(penguins<span class="sc">$</span>bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43.92193</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="fu">mean</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      m
  &lt;dbl&gt;
1  43.9</code></pre>
</div>
</div>
<ul>
<li>That being said, a function has a set of parameters to be specified that are specific to that function.</li>
</ul>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>